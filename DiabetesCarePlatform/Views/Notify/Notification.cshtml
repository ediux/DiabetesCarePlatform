@{
    ViewBag.Title = "通知";
}



<li class="dropdown">
    <a href="#" class="icon notification waves-effect waves-light" data-toggle="dropdown">
        <i class="material-icons">inbox</i> @if (Html.GetNotiftionCount() > 0)
        { <span class="label label-notification">@Html.GetNotiftionCountDisplay() </span>}
    </a>
    <ul id="notify_ul" class="dropdown-menu media-list pull-right animated fadeInDown">
        <li class="dropdown-header bg-indigo text-white">Notifications (5)</li>
        <li class="media">
            <a href="javascript:;" data-toggle="modal" data-target="#myModal" onclick="showNotify(this);">
                <div class="media-left"><img src="@Url.Content("~/Content/ColorAdmin/assets/img/user-1.jpg")" class="media-object" alt="" /></div>
                <div class="media-body">
                    <h6 class="media-heading">John Smith</h6>
                    <p>Quisque pulvinar tellus sit amet sem scelerisque tincidunt.</p>
                    <div class="text-muted f-s-11">25 minutes ago</div>
                </div>
            </a>
        </li>
        <li class="media">
            <a href="javascript:;">
                <div class="media-left"><img src="@Url.Content("~/Content/ColorAdmin/assets/img/user-2.jpg")" class="media-object" alt="" /></div>
                <div class="media-body">
                    <h6 class="media-heading">Olivia</h6>
                    <p>Quisque pulvinar tellus sit amet sem scelerisque tincidunt.</p>
                    <div class="text-muted f-s-11">35 minutes ago</div>
                </div>
            </a>
        </li>
        <li class="media">
            <a href="javascript:;">
                <div class="media-left"><i class="material-icons media-object bg-deep-purple">people</i></div>
                <div class="media-body">
                    <h6 class="media-heading"> New User Registered</h6>
                    <div class="text-muted f-s-11">1 hour ago</div>
                </div>
            </a>
        </li>
        <li class="media">
            <a href="javascript:;">
                <div class="media-left"><i class="material-icons media-object bg-blue">email</i></div>
                <div class="media-body">
                    <h6 class="media-heading"> New Email From John</h6>
                    <div class="text-muted f-s-11">2 hours ago</div>
                </div>
            </a>
        </li>
        <li class="dropdown-footer text-center">
            <a href="javascript:addNotify('hi','test');">View more</a>
        </li>
    </ul>
    <!--dialog-->
    <div class="modal fade" id="myModal" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" style="width:40%;">

            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" onclick="" aria-hidden="true">
                        ×
                    </button>
                    <h4 class="modal-title" id="myModalLabel"></h4>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group col-lg-6">
                                    <div class="col-sm-6">
                                        <input type="text" class="form-control" id="Content" name="Content" required />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger" onclick="">
                        確認
                    </button>
                </div>

            </div>
        </div>
    </div>
    <script>
            function showNotify(obj) {
                debugger;
                var header = $(obj).find(".media-heading").text();
                var content = $(obj).find(".text-muted f-s-11").text();
                $("#myModal #myModalLabel").val(header);
                $("#myModal #Content").val(content);
            }

            function addNotify(title,msg,datetime) {
                var li = '<li class="media"><a href="javascript:;"><div class="media-left"><i class="material-icons media-object bg-deep-purple">{Title}</i></div><div class="media-body"><h6 class="media-heading">{Msg}</h6><div class="text-muted f-s-11">{Time}</div></div></a></li>';
                li = li.replace('{Title}', title).replace('{Msg}', msg).replace('{Time}', timeSince(datetime));

                $("#notify_ul li:eq(0)").after(li);
            }

            function timeSince(date) {
                var t1 = new Date();
                var t2 = new Date(date);
                var dif = t1.getTime() - t2.getTime();

                var seconds = Math.floor(dif / 1000);

                var interval = Math.floor(seconds / 31536000);

                if (interval > 1) {
                    return interval + " years ago";
                }
                interval = Math.floor(seconds / 2592000);
                if (interval > 1) {
                    return interval + " months ago";
                }
                interval = Math.floor(seconds / 86400);
                if (interval > 1) {
                    return interval + " days ago";
                }
                interval = Math.floor(seconds / 3600);
                if (interval > 1) {
                    return interval + " hours ago";
                }
                interval = Math.floor(seconds / 60);
                if (interval > 1) {
                    return interval + " minutes ago";
                }
                return Math.floor(seconds) + " seconds ago";
            }
    </script>



</li>


